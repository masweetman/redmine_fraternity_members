<h2>All Members</h2>

<p>
<%= "Export To:" %>
<%= link_to "CSV", directory_path + "/export" %>
</p>

<%= form_tag(directory_path, :method => :get) do %>
<fieldset>
<label for='search'><%= 'Filter' %>:</label>
<%= text_field_tag 'search', params[:search], :size => 30 %>
<%= submit_tag l(:button_apply), :class => "small", :search => nil %>
<%= link_to l(:button_clear), directory_path, :class => 'icon icon-reload' %>
</fieldset>
<% end %>
&nbsp;

<div class="autoscroll">
<table class="list">
  <thead><tr>
  <%= sort_header_tag('chapter', :caption => 'Chapter') %>
  <%= sort_header_tag('active_number', :caption => 'Active #') %>
  <%= sort_header_tag('lastname', :caption => 'Name') %>
  <%= sort_header_tag('pledge_name', :caption => 'Pledge Name') %>
  <%= sort_header_tag('mail', :caption => 'Email') %>
  <%= sort_header_tag('phone', :caption => 'Phone') %>
  <%= sort_header_tag('address', :caption => 'Zip Code') %>
  </tr></thead>
  <tbody>
<% for f in @members -%>
  <tr class="<%= cycle("odd", "even") %>">
  	<td><%= h(f.chapter) %></td>
  	<td><%= h(f.active_number) %></td>
  	<td>
      <% uname = f.firstname + " " + f.lastname -%>
      <% ulink = "/redmine/users/" + f.redmine_user_id.to_s -%>
      <% if f.redmine_user_id.to_i > 0 -%>
      <%= link_to uname, ulink if f.redmine_user_id > 0 %>
      <% else -%>
      <%= uname %>
      <% end -%>
  	</td>
  	<td><%= h(f.pledge_name.truncate(18)) %></td>
  	<td><%= mail_to(h(f.mail)) %></td>
  	<td><%= h(f.phone) %></td>
  	<td><%= h(f.address) %></td>
  </tr>
<% end -%>
  </tbody>
</table>
</div>

<p class="pagination"><%= pagination_links_full @member_pages, @member_count, :per_page_links => false %></p>

