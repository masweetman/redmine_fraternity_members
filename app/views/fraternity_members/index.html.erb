<h2>All Members</h2>

<%= form_tag(directory_path, :method => :get) do %>
<fieldset>
<% options = ("<option value=''>#{ "Chapter..." }</option>" +
         '<option value="" disabled="disabled">---</option>' +
         '<option value="alpha">Alpha</option>' +
         '<option value="beta">Beta</option>' +
         '<option value="gamma">Gamma</option>' +
         '<option value="delta">Delta</option>' +
         '<option value="epsilon">Epsilon</option>' +
         '<option value="zeta">Zeta</option>' +
         '<option value="eta">Eta</option>' +
         '<option value="theta">Theta</option>' +
         '<option value="iota">Iota</option>' +
         '<option value="kappa">Kappa</option>' +
         '<option value="lambda">Lambda</option>' +
         '<option value="mu">Mu</option>' +
         '<option value="nu">Nu</option>' +
         '<option value="xi">Xi</option>' +
         '<option value="omicron">Omicron</option>' +
         '<option value="pi">Pi</option>' +
         '<option value="rho">Rho</option>' +
         '<option value="sigma">Sigma</option>' +
         '<option value="tau">Tau</option>').html_safe -%>
<%= select_tag('chapter', options, :onchange => params[:chapter]) %>

<label for='search'><%= 'Search' %>:</label>
<%= text_field_tag 'search', params[:search], :size => 30 %>
<%= submit_tag l(:button_apply), :class => "small", :search => nil %>
<%= " | " %><%= link_to "Export to CSV", :controller => 'fraternity_members', :action => 'export', :chapter => params[:chapter], :search => params[:search] %><%= " | " %>

<%= link_to l(:button_clear), directory_path, :class => 'icon icon-reload' %>
</fieldset>
<% end %>
&nbsp;

<div class="autoscroll">
<table class="list">
  <thead><tr>
  <%= sort_header_tag('chapter', :caption => 'Chapter') %>
  <%= sort_header_tag('active_number', :caption => 'Active #') %>
  <%= sort_header_tag('lastname', :caption => 'Name') %>
  <%= sort_header_tag('pledge_name', :caption => 'Pledge Name') %>
  <%= sort_header_tag('mail', :caption => 'Email') %>
  <%= sort_header_tag('phone', :caption => 'Phone') %>
  <%= sort_header_tag('address', :caption => 'Zip Code') %>
  </tr></thead>
  <tbody>
<% for f in @members -%>
  <tr class="<%= cycle("odd", "even") %>">
  	<td><%= h(f.chapter) %></td>
  	<td><%= h(f.active_number) %></td>
  	<td>
      <% if f.redmine_user_id.to_i > 0 -%>
        <% uname = f.firstname.to_s + " " + f.lastname.to_s -%>
        <% ulink = user_path(User.find(f.redmine_user_id.to_i)) -%>
        <%= link_to uname, ulink if f.redmine_user_id > 0 %>
      <% else -%>
        <%= uname %>
      <% end -%>
  	</td>
  	<td><%= h(f.pledge_name.to_s.truncate(18)) %></td>
  	<td><%= mail_to(h(f.mail)) %></td>
  	<td><%= h(f.phone) %></td>
  	<td><%= h(f.address) %></td>
  </tr>
<% end -%>
  </tbody>
</table>
</div>

<p class="pagination"><%= pagination_links_full @member_pages, @member_count, :per_page_links => false %></p>

